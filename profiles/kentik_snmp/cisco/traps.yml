# Cisco SNMP traps
---

traps:
  # Generic SNMP traps
  # https://oidref.com/static/circitor/SNMPv2-MIB.mib
  # need to see an example of this one to build the events/varbinds
  - trap_oid: 1.3.6.1.6.3.1.1.5.1
    trap_name: coldStart
    drop_undefined: false
  # need to see an example of this one to build the events/varbinds
  - trap_oid: 1.3.6.1.6.3.1.1.5.2
    trap_name: warmStart
    drop_undefined: false
  # need to see an example of this one to build the events/varbinds
  - trap_oid: 1.3.6.1.6.3.1.1.5.3
    trap_name: linkDown
    drop_undefined: false
  # need to see an example of this one to build the events/varbinds
  - trap_oid: 1.3.6.1.6.3.1.1.5.4
    trap_name: linkUp
    drop_undefined: false
  - trap_oid: 1.3.6.1.6.3.1.1.5.5
    trap_name: authenticationFailure
    drop_undefined: false
    events:
      - name: cExtSnmpTargetAuthInetType
        OID: 1.3.6.1.4.1.9.9.412.1.1.1.0
        enum:
          unknown: 0
          ipv4: 1
          ipv6: 2
          dns: 16
      - name: cExtSnmpTargetAuthInetAddr
        OID: 1.3.6.1.4.1.9.9.412.1.1.2.0
  # need to see an example of this one to build the events/varbinds
  - trap_oid: 1.3.6.1.6.3.1.1.5.6
    trap_name: authenticationFailure
    drop_undefined: false

  # https://mibs.observium.org/mib/CISCO-SYSLOG-MIB/
  - trap_oid: 1.3.6.1.4.1.9.9.41.2.0.1
    trap_name: clogMessageGenerated
    drop_undefined: false
    events:
      - name: clogHistFacility
        OID: 1.3.6.1.4.1.9.9.41.1.2.3.1.2
      - name: clogHistSeverity
        OID: 1.3.6.1.4.1.9.9.41.1.2.3.1.3
      - name: clogHistMsgName 	
        OID: 1.3.6.1.4.1.9.9.41.1.2.3.1.4
      - name: clogHistMsgText
        OID: 1.3.6.1.4.1.9.9.41.1.2.3.1.5
      - name: clogHistTimestamp
        OID: 1.3.6.1.4.1.9.9.41.1.2.3.1.6

  # https://oidref.com/static/circitor/CISCO-CONFIG-MAN-MIB.mib
  - trap_oid: 1.3.6.1.4.1.9.9.43.2.0.1
    trap_name: ciscoConfigManEvent
    drop_undefined: false
    events:
      - name: ccmHistoryEventCommandSource
        OID: 1.3.6.1.4.1.9.9.43.1.1.6.1.3
        enum:
          commandLine: 1
          snmp: 2
      - name: ccmHistoryEventConfigSource
        OID: 1.3.6.1.4.1.9.9.43.1.1.6.1.4
        enum:
          erase: 1
          commandSource: 2
          running: 3
          startup: 4
          local: 5
          networkTftp: 6
          networkRcp: 7
          networkFtp: 8
          networkScp: 9
      - name: ccmHistoryEventConfigDestination
        OID: 1.3.6.1.4.1.9.9.43.1.1.6.1.5
        enum:
          erase: 1
          commandSource: 2
          running: 3
          startup: 4
          local: 5
          networkTftp: 6
          networkRcp: 7
          networkFtp: 8
          networkScp: 9

  # https://oidref.com/static/circitor/CISCO-CONFIG-MAN-MIB.mib
  - trap_oid: 1.3.6.1.4.1.9.9.43.2.0.2
    trap_name: ccmCLIRunningConfigChanged
    drop_undefined: false
    events:
      - name: ccmHistoryRunningLastChanged
        OID: 1.3.6.1.4.1.9.9.43.1.1.1.0
      - name: ccmHistoryEventTerminalType
        OID: 1.3.6.1.4.1.9.9.43.1.1.6.1.6.3
        enum:
          notApplicable: 1
          unknown: 2
          console: 3
          terminal: 4
          virtual: 5
          auxiliary: 6
